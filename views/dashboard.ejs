<header id="main-header" class="pt-3 text-white" style="background-color: #236475">
  <div class="container">
    <div class="row">
      <div class="col-md-6">
        <h1>
          <i class="fa fa-gear"></i> Painel
        </h1>
      </div>
    </div>
  </div>
</header>

<!-- ACTIONS -->
<section id="action" class="py-4 mb-4 bg-faded">
  <div class="container">
    <div class="row">
      <div class="col-md-3">
        <!-- <a href="posts/add" class="btn btn-primary btn-block" data-toggle="modal" data-target="#addPostModal"><i class="fa fa-plus"></i> Adicionar Postagem</a> -->
        <a href="/posts/add" class="btn btn-info btn-block"><i class="fa fa-plus"></i> Adicionar Postagem</a>

      </div>
      <div class="col-md-3">
        <a href="/category/add" class="btn btn-info btn-block" data-toggle="modal" data-target="#addCategoryModal"><i class="fa fa-plus"></i> Adicionar Categoria</a>
      </div>
    </div>
  </div>
</section>

<%-include('./partials/_msg')%>

<!-- TABLE AREA -->
<section id="table-area-section" class="">
  <div class="container">
    <div class="row">
      <div class="col-md-9 col-lg-9">
        <div class="card border-primary">
          <div class="card-header bg-primary text-white">
            <h4>Suas Últimas Postagens</h4>
          </div>
          <%if(posts.length > 0){%>
<!-- //TODO:PASSAR ISTO PARA DFLEX TÁ SO FEIO COM UMA TABELA LOL -->
            <table class="table table-responsive table-hover ">
              <thead class="thead-dark">
                <tr>
                  <th class="w-50">Título</th>
                  <th class="w-25"></th>
                  <th class="w-25"></th>
                </tr>
              </thead>
              <tbody class="">
                <% moment.locale('pt_PT')%>
                  <% for(var i=posts.length-1; 0<=i; i--){ %>
                      <td>
                        <p>
                          <%-i+1-%>    <span class="text-muted pull-right"><%= moment(posts[i].date).format('DD-MM-YYYY HH:MM:SS') %></span>
                        </p>
                        <%= posts[i].title %>
                          <p>
                            <a class="text-muted" href="#" style="text-decoration: none;"><%= posts[i].category %></a>
                          </p>
                          <div class="text-muted">
                            <a href="#"><%= posts[i].authorName %></a>
                        </div>
                      </td>
                      <!-- <td><%= posts[i].category %></td> -->

                      <td class="pt-5">
                        <%- posts[i].body %>
                      </td>
                      <td class="text-center">
<!-- TODO: Se for o autor pode editar a publicação -->
                        <a href="/posts/edit/<%= posts[i]._id %>" class="btn border-secondary text-secondary mt-5"><i class="fa fa-angle-double-right"></i>Editar</a>
                          <a href="/posts/<%= posts[i]._id %>" class="btn border-secondary text-secondary mt-5"><i class="fa fa-angle-double-right"></i> Comentar</a>
                      </td>

                    </tr>
                    <%} %>
              </tbody>
            </table>

            <%}else{%>
              <div class="text-center mt-3">
                <p>Não foram adicionados nenhums posts :-O</p>
              </div>
              <%}%>
        </div>
      </div>

        <div class="col-lg-3 col-md-6 mb-5" id="info-card">
          <div class="card text-center  border-primary mb-3">
            <div class="card-header text-white bg-primary">
              <h4 class="card-title mt-2"><i class="fa fa-pencil"></i> Postagens</h4>
            </div>
            <div class="card-block card-text mt-3">
              <h1 class="display-4"><%=posts.length%></h1>
              <div class="card-footer">
                <a href="posts" class="btn btn-lg btn-info "> Ver</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <!-- MODALS (ADD POST; ADD CATEGORY)  ADICIONAR NO FUTURO-->
  <div class="modal fade" id="addPostModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="addPostModalLabel">Add Post</h5>
          <button class="close" data-dismiss="modal"><span>&times;</span></button>
        </div>
        <div class="modal-body">
          <form method="POST" action="/posts/add">
            <div class="form-group">
              <label for="title" class="firm-control-label">Title</label>
              <input type="text" class="form-control" name="title" required>
            </div>
            <div class="form-group">
              <label for="category" class="form-control-label">Category</label>
              <select name="category" class="form-control" required>
              <option value="exemplo1">Exemplo 1</option>
              <option value="exemplo2">Exemplo 2</option>
              <option value="exemplo3">Exemplo 3</option>
            </select>
            </div>
            <div class="form-group bg-faded p-3">
              <label for="file">Image Upload</label>
              <input type="file" name="file" value="" class="form-control-file" id="file">
              <small id="fileHelp" class="form-text text-muted">Tamanho máx 3MB</small>
            </div>
            <div class="form-group">
              <label for="body">Body</label>
              <textarea name="textarea" class="form-control" required></textarea>
            </div>
        </div>
        <%
        var d = new Date();
        var data = d.toISOString()
        %>
          <div class="modal-footer">
            <button class="btn btn-secondary" data-dismiss="modal">Fechar</button>
            <button type="submit" class="btn btn-primary">Adicionar Post</button>
          </div>
          </form>

      </div>
    </div>
  </div>

  <!-- MODALS (ADD CATEGORY)  -->
  <div class="modal fade" id="addCategoryModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-success text-white">
          <h5 class="modal-title" id="addPostModalLabel">Adicionar Categoria</h5>
          <button class="close" data-dismiss="modal"><span>&times;</span></button>
        </div>
        <div class="modal-body">
          <form method="POST" action="/categories/add">
            <div class="form-group">
              <label for="title" class="form-control-label">Nome da nova categoria</label>
              <input type="text" class="form-control" name="title" id="title" placeholder="Nome">
            </div>
            <div class="modal-footer">
              <button class="btn btn-secondary" data-dismiss="modal">Fechar</button>
              <input class="btn btn-success" type="submit" value="Adicionar categoria" />
            </div>
          </form>
        </div>
      </div>
    </div>


    <script src="https://cdn.ckeditor.com/4.8.0/standard/ckeditor.js"></script>
    <script>
      CKEDITOR.replace('textarea');
    </script>
